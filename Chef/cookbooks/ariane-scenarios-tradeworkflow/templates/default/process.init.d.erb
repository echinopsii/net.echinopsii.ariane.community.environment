#!/bin/sh
###
## Generated by Chef
###

PATH=/sbin:/usr/sbin:/bin:/usr/bin
DESC="<%= @processdesc %>"
START_CMD="<%= @processstartcmd %>"
MAIN_CLASS="<%= @processmainclass %>"

. /lib/lsb/init-functions
. /lib/init/vars.sh

RETVAL=0

start_process () {
    $START_CMD &
}

stop_process () {
    PID=`ps -aef | grep ${MAIN_CLASS} | grep -v grep | awk {'print $2'}`
    if [ "$PID" != "" ] ; then
       kill $PID
       RETVAL=0
    fi
    RETVAL=1
}

status_process () {
    PID=`ps -aef | grep ${MAIN_CLASS} | grep -v grep | awk {'print $2'}`
    if [ "$PID" != "" ] ; then
       echo "$DESC is running"
       RETVAL=0;
    else
       echo "$DESC is not running"
       RETVAL=1;
    fi
}

case "$1" in
    start)
        log_daemon_msg "Starting ${DESC}" $NAME
        start_process
        ;;
    stop)
        log_daemon_msg "Stopping ${DESC}" $NAME
        stop_process
        ;;
    status)
	status_process
	;;
    *)
	echo "Usage: $0 {start|status|stop}" >&2
        RETVAL=1
        ;;
esac

exit $RETVAL